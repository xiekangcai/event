import{k as E}from"./request-B3Ad40p0.js";import{E as x,a as F}from"./el-form-item-BWUY2lCO.js";import{E as P}from"./el-input-BYmQCSxn.js";import{f as b}from"./frame-DBvoc0qQ.js";import{i as y,a as B,c as A}from"./regx-C452OJq1.js";import{l as R}from"./loadingbtn-BZ-mPvrF.js";import{b as q}from"./user-TW22ef4x.js";import{u as C,f as p,e as m,o as I,l as L,w as l,b as s,h as f}from"./index-DVHjmt9v.js";import"./castArray-B_huPC4r.js";import"./index-Bu8mzvd8.js";import"./_Uint8Array-Bs8f7h5G.js";import"./el-main-CFZviiWk.js";const W=Object.assign({name:"resetAvartarlIndex"},{__name:"resetAvatar",setup(U){const w=C(),n=p(),d=p(!1),t=m({old_pwd:"",new_pwd:"",re_pwd:""}),_=m({old_pwd:[{validator:(o,e,r)=>{e===""?r(new Error("请输入原密码")):y(e,A)?r():r(new Error("长度至少6位"))},trigger:"blur"}],new_pwd:[{validator:(o,e,r)=>{e===""?r(new Error("请再次新密码")):e===t.old_pwd?r(new Error("新旧密码不能一致")):r()},trigger:"blur"}],re_pwd:[{validator:(o,e,r)=>{if(e){if(e!==t.new_pwd)return r(new Error("密码不一致"));r()}else return r(new Error("请输入确认密码"))},trigger:"blur"}]}),c=o=>{o&&o.validate(e=>{e?g():console.log("error submit!")})},i=o=>{o&&o.resetFields()};async function g(){try{d.value=!0;const o=await q(t);B(o.message,"success"),i(n.value),d.value=!1,w.replace("/sign/in")}catch{d.value=!1}}return(o,e)=>{const r=P,u=x,v=E,V=F;return I(),L(b,{title:"重置密码"},{main:l(()=>[s(V,{ref_key:"ruleFormRef",ref:n,style:{"max-width":"571px"},model:t,size:"large",rules:_,"label-width":"100px",class:"demo-ruleForm"},{default:l(()=>[s(u,{label:"原密码",prop:"old_pwd",required:""},{default:l(()=>[s(r,{modelValue:t.old_pwd,"onUpdate:modelValue":e[0]||(e[0]=a=>t.old_pwd=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),s(u,{label:"新密码",prop:"new_pwd",required:""},{default:l(()=>[s(r,{modelValue:t.new_pwd,"onUpdate:modelValue":e[1]||(e[1]=a=>t.new_pwd=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),s(u,{label:"确认新密码",prop:"re_pwd",required:""},{default:l(()=>[s(r,{modelValue:t.re_pwd,"onUpdate:modelValue":e[2]||(e[2]=a=>t.re_pwd=a),type:"password"},null,8,["modelValue"])]),_:1}),s(u,null,{default:l(()=>[s(R,{size:"large",isLoading:d.value,onClick:e[3]||(e[3]=a=>c(n.value))},{default:l(()=>[f(" 修改密码 ")]),_:1},8,["isLoading"]),s(v,{onClick:e[4]||(e[4]=a=>i(n.value))},{default:l(()=>[f("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}}});export{W as default};
